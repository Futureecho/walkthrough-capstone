<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Settings - Walkthru-X</title>
<link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
<div class="header">
  <div class="flex-between">
    <div class="header-inner">
      <a href="/owner"><img src="/static/images/walkthru-x-logo.png" alt="Walkthru-X" class="app-logo"></a>
      <div>
        <h1>Settings</h1>
        <div class="subtitle">AI Provider, Security &amp; Defaults</div>
      </div>
    </div>
    <a href="/owner" class="btn btn-ghost">Dashboard</a>
  </div>
</div>

<div class="container">
  <!-- AI Model Selection -->
  <div class="card">
    <h2>AI Model</h2>
    <select id="llm-provider">
      <option value="openai">OpenAI (GPT-4o)</option>
      <option value="anthropic">Anthropic (Claude)</option>
      <option value="gemini">Google Gemini</option>
      <option value="grok">xAI Grok</option>
      <option value="none">None &mdash; Manual Review</option>
    </select>
  </div>

  <!-- API Keys -->
  <div class="card">
    <h2>API Keys</h2>
    <label class="text-muted" style="font-size:.85rem;display:block;margin-bottom:.25rem">OpenAI API Key</label>
    <input type="password" id="openai-key" placeholder="sk-..." autocomplete="off">
    <span class="text-muted" style="font-size:.8rem" id="openai-status"></span>

    <label class="text-muted" style="font-size:.85rem;display:block;margin-bottom:.25rem;margin-top:.5rem">Anthropic API Key</label>
    <input type="password" id="anthropic-key" placeholder="sk-ant-..." autocomplete="off">
    <span class="text-muted" style="font-size:.8rem" id="anthropic-status"></span>

    <label class="text-muted" style="font-size:.85rem;display:block;margin-bottom:.25rem;margin-top:.5rem">Gemini API Key</label>
    <input type="password" id="gemini-key" placeholder="AI..." autocomplete="off">
    <span class="text-muted" style="font-size:.8rem" id="gemini-status"></span>

    <label class="text-muted" style="font-size:.85rem;display:block;margin-bottom:.25rem;margin-top:.5rem">Grok API Key</label>
    <input type="password" id="grok-key" placeholder="xai-..." autocomplete="off">
    <span class="text-muted" style="font-size:.8rem" id="grok-status"></span>
  </div>

  <!-- Defaults -->
  <div class="card">
    <h2>Defaults</h2>
    <label class="text-muted" style="font-size:.85rem;display:block;margin-bottom:.25rem">Default Link Duration (days)</label>
    <input type="number" id="default-days" min="1" max="90" value="7">
  </div>

  <button class="btn btn-primary btn-block" id="save-btn">Save Settings</button>
  <div id="save-msg" class="text-muted mt-1" style="text-align:center"></div>

  <!-- MFA Section -->
  <div class="card mt-2">
    <h2>Two-Factor Authentication</h2>
    <div id="mfa-status-area">
      <div class="spinner"></div>
    </div>

    <!-- MFA Setup (hidden by default) -->
    <div id="mfa-setup" class="hidden" style="margin-top:1rem">
      <p class="text-muted mb-1">Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)</p>
      <div id="mfa-qr" style="text-align:center;margin:1rem 0"></div>
      <p class="text-muted" style="font-size:.8rem;word-break:break-all">Manual key: <code id="mfa-secret-text"></code></p>
      <input type="text" id="mfa-verify-code" placeholder="Enter 6-digit code" maxlength="6" pattern="[0-9]{6}" inputmode="numeric"
             style="text-align:center;font-size:1.2rem;letter-spacing:.2em">
      <button class="btn btn-primary btn-block" id="mfa-verify-btn">Enable MFA</button>
      <div id="mfa-setup-msg" style="font-size:.85rem;text-align:center;margin-top:.5rem"></div>
    </div>

    <!-- MFA Disable (hidden by default) -->
    <div id="mfa-disable" class="hidden" style="margin-top:1rem">
      <p class="text-muted mb-1">Enter your password and current TOTP code to disable MFA.</p>
      <input type="password" id="mfa-disable-password" placeholder="Password" autocomplete="current-password">
      <input type="text" id="mfa-disable-code" placeholder="6-digit code" maxlength="6" pattern="[0-9]{6}" inputmode="numeric"
             style="text-align:center;font-size:1.2rem;letter-spacing:.2em">
      <button class="btn btn-block" id="mfa-disable-btn" style="background:var(--danger);color:#fff">Disable MFA</button>
      <div id="mfa-disable-msg" style="font-size:.85rem;text-align:center;margin-top:.5rem"></div>
    </div>
  </div>
</div>

<script src="/static/js/owner-settings.js"></script>
</body>
</html>
